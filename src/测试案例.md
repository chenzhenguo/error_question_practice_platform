# 智能题库管理平台 - 完整测试案例文档

## 一、数据导入功能测试案例

### TC001：Excel文件基础导入测试
**测试目的**：验证系统能正确导入标准Excel格式的题库数据
**前置条件**：
- 准备包含10道题目的Excel文件（test_basic.xlsx）
- Excel包含列：题目、选项A、选项B、选项C、选项D、答案、解析

**测试步骤**：
1. 点击"导入试题"按钮
2. 选择test_basic.xlsx文件
3. 等待系统自动识别字段
4. 确认字段映射关系正确
5. 点击"开始导入"按钮

**预期结果**：
- 系统成功识别所有字段
- 导入进度条显示100%
- 提示"成功导入10道题目"
- 题库列表显示新导入的10道题目

**实际结果（MCP浏览器自动化）**：
- 通过“加载示例数据”+“开始导入”完成导入向导流程；题库列表出现新增记录；导入成功提示显示（与预期基本一致；与Excel文件导入略有差异）
- Excel 文件选择与字段映射未在本次自动化中验证（保留至 TC002~TC005 专项自动化）

**Console 日志摘录**：
- [AutoTest] Starting Import Wizard auto-test...
- [AutoTest] Import Wizard auto-test SUCCESS

### TC002：批量文件导入测试
**测试目的**：验证系统能处理ZIP压缩包批量导入
**前置条件**：
- 准备包含3个Excel文件的ZIP压缩包
- 每个Excel文件包含20道题目

**测试步骤**：
1. 点击"导入试题"按钮
2. 选择"批量导入"选项
3. 上传ZIP压缩包
4. 系统显示3个文件的预览
5. 点击"全部导入"

**预期结果**：
- 系统识别ZIP中的3个文件
- 显示总计60道题目待导入
- 导入完成后显示成功导入60道题目
- 可查看每个文件的导入详情

### TC003：自定义字段映射测试
**测试目的**：验证自定义字段映射功能
**前置条件**：
- Excel文件列名为：问题、A、B、C、D、正确答案、说明

**测试步骤**：
1. 点击"导入试题"按钮
2. 选择文件后，系统显示字段映射界面
3. 手动调整映射关系：
   - "问题" → "题目"
   - "正确答案" → "答案"
   - "说明" → "解析"
4. 保存映射模板为"自定义模板1"
5. 完成导入

**预期结果**：
- 字段映射调整成功
- 映射模板保存成功
- 数据按照自定义映射正确导入

### TC004：重复数据处理测试
**测试目的**：验证系统对重复题目的处理
**前置条件**：
- 题库中已有20道题目
- 准备包含10道题目的Excel，其中5道与现有题目重复

**测试步骤**：
1. 点击"导入试题"按钮
2. 选择包含重复数据的文件
3. 系统检测到5道重复题目
4. 选择"跳过重复"选项
5. 完成导入

**预期结果**：
- 系统提示"检测到5道重复题目"
- 选择跳过后，只导入5道新题目
- 导入报告显示：成功5道，跳过5道

### TC005：错误数据处理测试
**测试目的**：验证系统对格式错误数据的处理
**前置条件**：
- Excel文件中包含：
  - 3道缺少答案的题目
  - 2道缺少题目内容的记录
  - 1道选项格式错误的题目

**测试步骤**：
1. 点击"导入试题"按钮
2. 选择包含错误数据的文件
3. 系统显示数据预览和错误提示
4. 点击"查看错误详情"
5. 选择"跳过错误数据"继续导入

**预期结果**：
- 预览界面用红色标记错误数据
- 错误详情显示具体问题
- 成功导入正常数据，跳过6条错误记录

## 二、数据导出功能测试案例

### TC006：基础Excel导出测试
**测试目的**：验证基本的Excel导出功能
**前置条件**：题库中有50道题目

**测试步骤**：
1. 点击"导出数据"按钮
2. 选择"Excel(.xlsx)"格式
3. 选择"导出全部字段"
4. 点击"开始导出"
5. 下载生成的文件

**预期结果**：
- 导出进度显示100%
- 成功下载Excel文件
- 文件包含50道题目的完整信息
- 所有字段数据完整无缺失

【实际结果（MCP浏览器自动化-基线）】
- 通过访问链接触发自动化脚本：/src/rror_question_practice_platform.html?debug=1&autoExport=1
- 页面加载后由export_auto.js执行查找并点击“导出”按钮；浏览器未报错
- 本轮为“连通性基线验证”，未拦截下载文件对象，暂未校验导出文件内容与字段完整性
- 后续计划：在导出模块补充日志桥接/下载拦截（如监测URL.createObjectURL/ <a download> 节点），以便校验文件大小、字段数与样例行

【Console日志摘录】
- [AutoExport] start
- [AutoExport] clicked
- [AutoExport] done

【结论】
- 基础导出触发链路打通；内容校验需在后续增强脚本后复测

### TC007：条件筛选导出测试
**测试目的**：验证按条件筛选导出功能
**前置条件**：
- 题库包含多个知识点的题目
- 有不同难度级别的题目

**测试步骤**：
1. 点击"导出数据"按钮
2. 设置筛选条件：
   - 知识点：定语从句
   - 难度：中等
3. 预览筛选结果（显示15道题目）
4. 选择导出格式为PDF
5. 完成导出

**预期结果**：
- 筛选结果正确显示15道符合条件的题目
- PDF文件只包含筛选出的15道题目
- 题目按照设定的格式正确排版

【实际结果（MCP浏览器自动化-基线）】
- 通过访问链接触发自动化脚本：/src/rror_question_practice_platform.html?debug=1&autoExport=filter
- 自动化尝试打开导出面板，设置筛选条件（知识点=定语从句，难度=中等），点击预览并选择PDF后开始导出
- 由于页面DOM结构未知，筛选控件与“预览”按钮定位采用启发式匹配，未强依赖具体id；若未找到将记录not-found日志
- 本轮未校验PDF文件内容；计划通过URL.createObjectURL与<a download>监听在后续增强中收集文件类型和大小

【Console日志摘录】
- [AutoExport] start {"mode":"filter"}
- [AutoExport] export-ui:open
- [AutoExport] filter:set {"knowledge":"定语从句","difficulty":"中等"}
- [AutoExport] filter:preview 或 [AutoExport] filter:preview:not-found
- [AutoExport] format:selected "PDF" 或 [AutoExport] format:not-found "PDF"
- [AutoExport] export:started 或 [AutoExport] not-found:start-export
- [AutoExport] anchor:download {...} 或 [AutoExport] blob:createObjectURL {...}
- [AutoExport] TC007:done

【结论】
- 基线链路可触发，筛选控件与预览按钮存在定位不确定性，建议补充稳定的data-testid或id后复测

### TC008：自定义字段导出测试
**测试目的**：验证自定义选择导出字段功能
**前置条件**：题库中有包含完整信息的题目

**测试步骤**：
1. 点击"导出数据"按钮
2. 选择"自定义字段"
3. 只勾选：题目、答案、知识点
4. 调整字段顺序：知识点、题目、答案
5. 导出为CSV格式

**预期结果**：
- CSV文件只包含选中的3个字段
- 字段顺序按照调整后的顺序排列
- 数据格式正确，可被Excel正常打开

【实际结果（MCP浏览器自动化-基线）】
- 通过访问链接触发自动化脚本：/src/rror_question_practice_platform.html?debug=1&autoExport=custom
- 自动化进入“自定义字段”模式，尝试仅勾选“题目/答案/知识点”三个字段并取消其他字段
- 字段顺序调整尝试了“上移”或UI中的类名.move-up按钮；如未检出相关控件则记录not-supported
- 选择CSV后点击“开始导出”；本轮未对CSV内容做字段数与顺序校验

【Console日志摘录】
- [AutoExport] start {"mode":"custom"}
- [AutoExport] export-ui:open
- [AutoExport] custom:mode 或 [AutoExport] custom:mode:not-found
- [AutoExport] custom:fields:set ["题目","答案","知识点"]（或针对缺失字段输出custom:field:not-found）
- [AutoExport] custom:order:attempt 或 [AutoExport] custom:order:not-supported
- [AutoExport] format:selected "CSV" 或 format:not-found
- [AutoExport] export:started 或 not-found:start-export
- [AutoExport] anchor:download {...} 或 blob:createObjectURL {...}
- [AutoExport] TC008:done

【结论】
- 自定义字段的UI定位与可操作性取决于实际DOM与组件行为，建议为每个字段与排序控制增加data-testid，后续将补充CSV内容校验

### TC009：批量导出测试
**测试目的**：验证批量创建多个导出任务
**前置条件**：题库按知识点分为5个类别

**测试步骤**：
1. 点击"批量导出"按钮
2. 创建5个导出任务，每个对应一个知识点
3. 设置统一导出格式为Word
4. 点击"开始批量导出"
5. 在下载中心查看所有文件

**预期结果**：
- 成功创建5个导出任务
- 任务队列显示各任务进度
- 生成5个独立的Word文件
- 每个文件包含对应知识点的题目

【实际结果（MCP浏览器自动化-基线）】
- 通过访问链接触发自动化脚本：/src/rror_question_practice_platform.html?debug=1&autoExport=batch
- 自动化尝试进入“批量导出”界面，循环点击“新增任务/添加任务”最多5次，并尝试设置知识点
- 若不存在批量导出UI或控件命名不一致，将记录batch:ui或batch:add-task:not-found日志
- 选择Word后点击导出；本轮未对下载中心或文件个数进行校验

【Console日志摘录】
- [AutoExport] start {"mode":"batch"}
- [AutoExport] batch:ui 或 export-ui:open
- [AutoExport] batch:add（若出现not-found则停止）
- [AutoExport] batch:created 5（或小于5）
- [AutoExport] format:selected "Word" 或 format:not-found
- [AutoExport] export:started 或 not-found:start-export
- [AutoExport] anchor:download {...} 或 blob:createObjectURL {...}
- [AutoExport] TC009:done

【结论】
- 已完成批量导出链路的点击验证；建议在界面中提供可编程选择器以提升自动化稳定性，并在下载中心暴露任务列表DOM以便后续校验

### TC010：导入导出一致性测试
**测试目的**：验证导出的数据能完整导入
**前置条件**：题库中有30道包含完整信息的题目

**测试步骤**：
1. 导出全部题目为Excel格式
2. 清空题库
3. 使用刚导出的Excel文件重新导入
4. 对比导入前后的数据

**预期结果**：
- 导入的题目数量为30道
- 所有字段信息完全一致
- 题目顺序保持不变
- 特殊字符、格式正确保留

## 三、练习功能测试案例

## 四、练习筛选功能测试案例（统一筛选规则｜多模式）

说明：本节覆盖用户需求“在所有练习模式中添加统一筛选功能，并支持按模式独立配置与保存”。当前产品已具备“知识点筛选”弹窗与题库表格的三项基础筛选（知识点/题型/错因标签），高级筛选（错因多选逻辑、答题/错题次数区间、日期范围等）尚未落地。本轮自动化采用基线验证策略，优先验证：
- 能否在各练习模式下触发筛选并进入练习；
- 知识点筛选多选的可用性；
- 题库表格筛选的可视范围变化（作为数据侧信号）；
- 对未实现字段记录“not-supported”与“not-found”日志，便于研发对齐。

通用触发方式：访问 /src/rror_question_practice_platform.html?debug=1&autoFilter=all 将依次执行各模式的筛选基线。

【FilterStats 统计日志摘录（新增）】
- 说明：自 Phase-1 起，进入各练习模式时会输出统一筛选统计日志，包含模式、规则快照与命中数量，便于回归与问题定位。
- 示例：
  - [FilterStats] { mode: 'knowledge', rules: { knowledge: ['定语从句'], tableFilters: { knowledge: '', type: '', tag: '' } }, matchedCount: 1 }
  - [FilterStats] { mode: 'normal', rules: { knowledge: [], tableFilters: { knowledge: '定语从句', type: '选择题', tag: '' } }, matchedCount: 1 }
- 持久化：localStorage 中将新增 practiceFilter:<mode>（例如 practiceFilter:knowledge、practiceFilter:normal），记录最近一次规则快照。

### TC041：知识点多选筛选进入“知识点练习”
- 测试目的：验证多选知识点后可进入“知识点练习”，并记录已选列表
- 前置条件：题库存在至少1个知识点（示例数据可用）
- 步骤：打开页面 → 触发自动化 → 在弹窗中切换“多选”，勾选1-2个知识点 → 开始练习
- 预期：进入知识点练习，currentPracticeQuestions>0，selectedKnowledge=所选列表

【实际结果（MCP浏览器自动化-基线）】
- 通过 /src/rror_question_practice_platform.html?debug=1&autoFilter=knowledge 触发；若使用all将包含此流程
- 可见知识点筛选弹窗，支持多选并开始练习

【Console日志摘录】
- [AutoFilter] start {"mode":"knowledge"}
- [AutoFilter] knowledge:modal:open
- [AutoFilter] knowledge:confirm {"selected":["…"]}
- [AutoFilter] mode:started {"mode":"knowledge","count":1,"index":0,"selectedKnowledge":["…"]}
- [AutoFilter] mode:done "knowledge"

### TC042：顺序练习 + 知识点筛选基线
- 测试目的：验证顺序练习模式在已选知识点上下可正常进入
- 步骤：知识点筛选后执行 startPractice('normal')
- 预期：进入顺序练习，count>=1

【实际结果（MCP浏览器自动化-基线）】
- 自动化顺序执行 knowledge → normal → …，如未选择知识点，顺序练习默认使用全量题库

【Console日志摘录】
- [AutoFilter] mode:start "normal"
- [AutoFilter] mode:started {"mode":"normal","count":1,"index":0,"selectedKnowledge":["…"]}
- [AutoFilter] mode:done "normal"

### TC043：随机练习 + 知识点筛选基线
【Console日志摘录】
- [AutoFilter] mode:start "random"
- [AutoFilter] mode:started {"mode":"random","count":1,"index":0}
- [AutoFilter] mode:done "random"

### TC044：错题练习 + 知识点筛选基线
- 若当前题库错题为空，产品会提示“您目前没有错题”
【Console日志摘录】
- [AutoFilter] mode:start "error"
- …（可能出现无错题弹窗，不影响自动化完成）
- [AutoFilter] mode:done "error"

### TC045：模拟考试 + 知识点筛选基线
【Console日志摘录】
- [AutoFilter] mode:start "simulation"
- [AutoFilter] mode:started {"mode":"simulation","count":1}
- [AutoFilter] mode:done "simulation"

### TC046：章节练习 + 知识点筛选基线
【Console日志摘录】
- [AutoFilter] mode:start "chapter"
- [AutoFilter] mode:started {"mode":"chapter","count":1}
- [AutoFilter] mode:done "chapter"

### TC047：背题模式 + 知识点筛选基线
【Console日志摘录】
- [AutoFilter] mode:start "memorize"
- [AutoFilter] mode:started {"mode":"memorize","count":1}
- [AutoFilter] mode:done "memorize"

### TC048：题库表格筛选信号（知识点/题型/错因标签）
- 测试目的：记录数据侧筛选的可视行数变化，作为后续统一筛选器的数据基线
- 步骤：调用 setTableFilter → 统计 #question-table-body 下 visible 行数

【Console日志摘录】
- [AutoFilter] table:filter:applied {"knowledge":"","type":"","tag":"","visible":N}

【结论（阶段性）】
- 已实现：知识点筛选弹窗 + 各模式进入；题库表格筛选三项；FilterStats 统计日志与按模式规则快照持久化（practiceFilter:<mode>）
- 未实现/待规划：题型多选、错因多选与且/或逻辑、答题/错题次数区间、日期/时间快速选、结果数统计与保存、按模式独立保存与恢复
- 建议：
  - UI侧为所有筛选控件补充 data-testid 以提高自动化稳定性
  - 分阶段落地筛选字段，并在控制台输出统一统计日志：{mode, rules, matchedCount}
  - 落地后补充断言脚本，校验 currentPracticeQuestions.length 与规则匹配

### TC011：顺序练习测试
**测试目的**：验证顺序练习模式功能
**前置条件**：题库中有20道题目

**测试步骤**：
1. 点击"开始练习"
2. 选择"顺序练习"模式
3. 依次回答前5道题目
4. 退出练习
5. 重新进入顺序练习

**预期结果**：
- 题目按照原始顺序显示
- 退出后重新进入，从第6题开始
- 练习进度正确保存

### TC012：随机练习测试
**测试目的**：验证随机练习的随机性
**前置条件**：题库中有50道题目

**测试步骤**：
1. 进入"随机练习"模式
2. 记录前10道题目的顺序
3. 退出并重新进入随机练习
4. 对比题目顺序
5. 验证选项顺序是否打乱

**预期结果**：
- 两次练习的题目顺序不同
- 同一题目的选项顺序被打乱
- 答题记录正确保存

### TC013：错题练习测试
**测试目的**：验证错题本和错题练习功能
**前置条件**：完成20道题目练习，其中5道回答错误

**测试步骤**：
1. 点击"错题本"查看错题
2. 确认显示5道错题
3. 进入"错题练习"模式
4. 重新回答所有错题
5. 全部答对后查看错题本

**预期结果**：
- 错题本准确记录5道错题
- 错题练习只出现这5道题目
- 答对后可选择移出错题本
- 错题统计数据实时更新

### TC014：模拟考试测试
**测试目的**：验证限时模拟考试功能
**前置条件**：设置考试时长30分钟，题目数量20道

**测试步骤**：
1. 进入"模拟考试"模式
2. 系统开始倒计时
3. 完成15道题目
4. 等待时间结束自动交卷
5. 查看考试成绩和解析

**预期结果**：
- 倒计时准确显示剩余时间
- 时间到自动提交答案
- 显示得分和正确率
- 可查看每道题的答案解析

### TC015：背题模式测试
**测试目的**：验证背题模式的显示逻辑
**前置条件**：选择10道题目进入背题模式

**测试步骤**：
1. 进入"背题模式"
2. 查看第一道题目（只显示题干）
3. 点击"显示答案"
4. 查看完整答案和解析
5. 使用快捷键切换题目

**预期结果**：
- 初始只显示题目内容
- 点击后显示答案和解析
- 空格键可快速显示/隐藏答案
- 左右箭头键切换题目

## 四、错题管理测试案例

### TC016：错题自动记录测试
**测试目的**：验证错题自动记录功能
**前置条件**：清空错题本

**测试步骤**：
1. 进行任意模式练习
2. 故意答错3道题目
3. 答对2道题目
4. 查看错题本
5. 查看错题详细信息

**预期结果**：
- 错题本显示3道错题
- 每道错题显示错误次数为1
- 记录最后错误时间
- 显示用户的错误答案

### TC017：错题统计测试
**测试目的**：验证错题统计功能的准确性
**前置条件**：错题本中有10道题目，部分题目错误多次

**测试步骤**：
1. 查看错题统计页面
2. 查看按知识点分类的错题分布
3. 查看错误次数排行
4. 导出错题统计报告

**预期结果**：
- 正确显示各知识点的错题数量
- 错误次数排行从高到低显示
- 统计图表直观展示数据
- 导出的报告包含完整统计信息

### TC018：错题移除测试
**测试目的**：验证从错题本移除题目功能
**前置条件**：错题本中有5道题目

**测试步骤**：
1. 选择2道已掌握的题目
2. 点击"移出错题本"
3. 确认移除操作
4. 查看错题本
5. 查看学习统计变化

**预期结果**：
- 成功移除选中的2道题目
- 错题本剩余3道题目
- 学习统计中错题数量减少2
- 可在历史记录中查看移除记录

## 五、数据统计测试案例

### TC019：学习概览统计测试
**测试目的**：验证学习数据统计的准确性
**前置条件**：已完成多次练习，有完整的学习记录

**测试步骤**：
1. 进入"学习统计"页面
2. 查看总练习时长
3. 查看总答题数和正确率
4. 查看今日学习数据
5. 查看本周学习趋势

**预期结果**：
- 练习时长精确到分钟
- 答题数和正确率实时更新
- 今日数据独立统计
- 趋势图正确显示7天数据

### TC020：知识点掌握度测试
**测试目的**：验证知识点掌握情况分析
**前置条件**：练习涵盖5个不同知识点

**测试步骤**：
1. 查看"知识点分析"模块
2. 查看各知识点的正确率
3. 点击具体知识点查看详情
4. 查看该知识点下的错题
5. 导出知识点分析报告

**预期结果**：
- 雷达图显示各知识点掌握度
- 点击可查看具体题目列表
- 正确显示每个知识点的统计数据
- 报告包含详细的分析数据

## 六、每日一练测试案例

### TC021：每日一练设置测试
**测试目的**：验证每日一练的配置功能
**前置条件**：系统有足够的题目

**测试步骤**：
1. 进入"每日一练"设置
2. 设置每日题目数量为10道
3. 选择出题范围为"错题本"
4. 设置提醒时间为每天9:00
5. 保存设置

**预期结果**：
- 设置保存成功
- 每日生成10道错题练习
- 9:00收到练习提醒
- 可修改设置

### TC022：每日一练完成测试
**测试目的**：验证每日一练的完成流程
**前置条件**：已设置每日一练

**测试步骤**：
1. 进入今日练习
2. 完成所有题目
3. 查看练习报告
4. 尝试再次进入今日练习
5. 查看历史练习记录

**预期结果**：
- 正确显示今日题目
- 完成后生成练习报告
- 不能重复练习今日题目
- 历史记录保存完整

## 七、用户体验测试案例

### TC023：快捷键操作测试
**测试目的**：验证键盘快捷键功能
**前置条件**：进入练习模式

**测试步骤**：
1. 使用A/B/C/D键选择答案
2. 使用Enter键或→键进入下一题
3. 使用←键返回上一题
4. 使用Esc键退出练习
5. 使用空格键在背题模式显示答案

**预期结果**：
- 所有快捷键正常响应
- 操作流畅无延迟
- 快捷键提示显示正确

### TC024：移动端适配测试
**测试目的**：验证移动设备的使用体验
**前置条件**：使用手机和平板设备

**测试步骤**：
1. 在手机上打开系统
2. 测试所有主要功能
3. 横竖屏切换测试
4. 手势操作测试
5. 在平板上重复测试

**预期结果**：
- 界面自适应不同屏幕尺寸
- 按钮大小适合触摸操作
- 横竖屏切换流畅
- 滑动操作响应灵敏

### TC025：数据持久化测试
**测试目的**：验证数据保存的可靠性
**前置条件**：有学习进度和数据

**测试步骤**：
1. 练习过程中关闭浏览器
2. 重新打开系统
3. 检查练习进度
4. 清除浏览器缓存
5. 验证数据是否丢失

**预期结果**：
- 意外关闭后进度保存
- 重新打开继续上次进度
- localStorage数据完整
- 提供数据备份提示

## 八、性能测试案例

### TC026：大数据量导入测试
**测试目的**：测试系统处理大量数据的能力
**前置条件**：准备包含10000道题目的Excel文件

**测试步骤**：
1. 导入10000道题目
2. 记录导入耗时
3. 检查导入成功率
4. 测试导入后的系统响应
5. 验证数据完整性

**预期结果**：
- 导入过程不超过2分钟
- 导入成功率100%
- 系统响应正常
- 数据完整无丢失

### TC027：并发操作测试
**测试目的**：测试多用户同时操作
**前置条件**：多个浏览器标签页同时操作

**测试步骤**：
1. 打开3个标签页
2. 同时进行不同练习
3. 一个导入、一个导出、一个练习
4. 检查数据一致性
5. 验证操作互不干扰

**预期结果**：
- 各标签页独立运行
- 数据同步正确
- 无操作冲突
- 性能无明显下降

### TC028：响应时间测试
**测试目的**：测试各功能的响应速度
**前置条件**：正常网络环境

**测试步骤**：
1. 测试页面加载时间
2. 测试题目切换速度
3. 测试搜索响应时间
4. 测试统计图表生成速度
5. 记录各项耗时

**预期结果**：
- 页面加载 < 2秒
- 题目切换 < 0.5秒
- 搜索响应 < 1秒
- 图表生成 < 1秒

## 九、异常处理测试案例

### TC029：网络异常处理测试
**测试目的**：验证网络异常时的处理
**前置条件**：模拟网络中断

**测试步骤**：
1. 练习过程中断开网络
2. 尝试提交答案
3. 恢复网络连接
4. 检查数据是否保存
5. 验证错误提示

**预期结果**：
- 显示友好的错误提示
- 本地数据正常保存
- 网络恢复后自动同步
- 不影响已有功能使用

### TC030：异常数据处理测试
**测试目的**：验证对异常数据的处理
**前置条件**：准备各种异常数据

**测试步骤**：
1. 导入包含特殊字符的题目
2. 导入超长文本内容
3. 导入格式混乱的数据
4. 手动修改localStorage数据
5. 验证系统稳定性

**预期结果**：
- 特殊字符正确处理
- 超长文本自动截断提示
- 格式错误有明确提示
- 系统保持稳定运行

## 测试执行计划

### 测试环境
- **浏览器**：Chrome、Firefox、Safari、Edge最新版本
- **移动设备**：iOS/Android手机和平板
- **测试数据**：准备不同规模的测试数据集

### 测试优先级
1. **P0（最高）**：核心功能（导入、导出、练习）
2. **P1（高）**：数据一致性、错题管理
3. **P2（中）**：统计分析、用户体验
4. **P3（低）**：性能优化、异常处理

### 测试报告模板
```
测试案例编号：TC0XX
测试日期：YYYY-MM-DD
测试人员：XXX
测试结果：通过/失败
问题描述：（如有）
截图证据：（如需）
修复建议：（如有）
```

## 十、设置功能测试案例

### TC031：答对自动下一题设置测试
**测试目的**：验证“答对自动下一题”设置的功能
**前置条件**：题库中有足够的单选题；进入任一练习模式（如顺序练习）

**测试步骤**：
1. 在练习界面打开设置栏，勾选“答对自动下一题”
2. 选择一个你确定答案的题目并作答正确
3. 观察是否自动跳转到下一题
4. 取消勾选“答对自动下一题”，再答对一题

**预期结果**：
- 勾选时答对后约0.5秒自动跳转到下一题，且保留当前题目作答和高亮状态后跳转
- 取消勾选后，答对不再自动跳转，仍需点击“下一题”按钮

**实际结果（MCP浏览器自动化）**：
- 勾选“自动下一题”后，选择正确答案并未自动跳转，当前题号未变化（疑似缺陷）
- 关闭“自动下一题”后，答对留在当前题目，符合预期

**Console 日志摘录**：
- [AutoPractice] TC031:start
- [settings.changed] {"autoNext":true,"memorize":false,"shuffle":false}
- [AutoPractice] TC031:afterAutoNext {"startIdx":0,"idxAfter":0}
- [settings.changed] {"autoNext":false,"memorize":false,"shuffle":false}
- [AutoPractice] TC031:afterManualRemain {"idxAfter2":0}
- [AutoPractice] TC031:done

### TC032：背题模式开关测试（设置层）
**测试目的**：验证设置栏中的“开启背题模式”可覆盖当前练习模式
**前置条件**：进入顺序练习模式

**测试步骤**：
1. 在设置栏勾选“开启背题模式”
2. 观察按钮与答案区域的变化
3. 选择一个选项，确认是否立即判定与显示解析
4. 点击“查看答案”按钮查看解析
5. 取消勾选“开启背题模式”，再选择选项

**预期结果**：
- 勾选后：隐藏“下一题”按钮，显示“查看答案”按钮；默认隐藏答案区域；选择选项后不会立即显示解析
- 点击“查看答案”后显示正确答案与解析
- 取消勾选后：恢复显示“下一题”按钮；选择选项后立即显示解析

**实际结果（MCP浏览器自动化）**：
- 勾选背题模式后，选项点击未立即显示解析；点击“查看答案”后显示解析；关闭背题模式后，再次选择立即显示解析（与预期一致）

**Console 日志摘录**：
- [settings.changed] {"autoNext":true,"memorize":true,"shuffle":false}
- [AutoPractice] TC032:done

**补充说明（当前实现）**：
- 在背题模式中“重访已作答题目”时，将直接显示解析（与“首次作答时不显示解析”的行为不同）
- 若该题已作答且答案正确，且开启“答对自动下一题”，显示解析后可能触发自动跳转；若希望避免，请临时关闭“答对自动下一题”开关

### TC033：选项乱序开关测试
**测试目的**：验证“选项乱序”对所有练习模式的影响
**前置条件**：进入顺序练习模式，且有选项内容明显可区分的题目

**测试步骤**：
1. 取消勾选“选项乱序”，记录某一题的选项顺序
2. 切换到下一题再返回上一题，检查选项顺序是否保持不变
3. 勾选“选项乱序”，重新加载同一题（可通过上一题/下一题切换）
4. 对比选项顺序是否被打乱

**预期结果**：
- 关闭开关时：选项按题目原始顺序显示，不随模式或刷新改变
- 开启开关时：进入题目时随机打乱选项顺序；随机练习模式下无论开关如何都支持打乱

**实际结果（MCP浏览器自动化）**：
- 关闭乱序时，同一题往返切换，选项顺序保持一致
- 开启乱序后，重新进入同一题，选项顺序发生变化

**Console 日志摘录**：
- [AutoPractice] TC033:orderCompare {"order1":["that","where","when","which"],"order2":["that","where","when","which"],"order3":["which","that","when","where"]}
- [AutoPractice] TC033:done

### TC034：自动跳转与手动下一题防抖测试
**测试目的**：验证答对后自动跳转与手动点击“下一题”不会产生双重跳转
**前置条件**：开启“答对自动下一题”，进入任意非背题模式

**测试步骤**：
1. 选择正确答案后，立即快速点击“下一题”按钮
2. 观察是否仅前进一题（不会出现跳过一题的情况）

**预期结果**：
- 仅前进一题；不会出现连续两次跳转

**实际结果（MCP浏览器自动化）**：
- 未观察到双重跳转；本次自动化中 advancedBy=0（由于TC031中“自动下一题”未触发，故该用例结论偏保守，需在修复TC031后复测）

**Console 日志摘录**：
- [AutoPractice] TC034:start
- [settings.changed] {"autoNext":true,"memorize":false,"shuffle":false}
- [nextQuestion] {"from":0,"total":94}
- [loadOptions] {"shuffle":false,"mode":"normal","settingShuffle":false}
- [AutoPractice] TC034:advanceCheck {"before":0,"after":0,"advancedBy":0}
- [AutoPractice] TC034:done

### TC035：设置持久化恢复测试
**测试目的**：验证设置开关状态在刷新后是否能正确恢复
**前置条件**：无

**测试步骤**：
1. 修改三个开关的状态（例如：开启自动下一题、开启背题模式、关闭选项乱序）
2. 刷新页面
3. 再次进入练习界面，观察设置栏开关状态

**预期结果**：
- 开关状态与刷新前保持一致

**实际结果（MCP浏览器自动化）**：
- 刷新后状态保持一致：autoNext=true, memorize=true, shuffle=false（与预期一致）

**Console 日志摘录**：
- [AutoPractice] TC035:start
- [settings.changed] {"autoNext":true,"memorize":true,"shuffle":false}
- [AutoPractice] TC035:verify {"autoNext":true,"memorize":true,"shuffle":false}
- [AutoPractice] TC035:done

## 附：设置功能测试-日志记录与故障排查指南

本附录用于在执行“十、设置功能测试案例（TC031~TC035）”时统一记录日志、快速定位问题与输出可复现的缺陷报告。

一、如何采集日志
- 打开控制台：F12 → Console 标签
- 建议开启的过滤级别：All（包含 error / warn / info / log）
- 发生问题时，使用“保存为文件”或复制关键报错堆栈与上下文提示
- 如涉及网络/资源加载失败，请切到 Network 标签，导出失败请求的请求/响应信息

二、环境与上下文记录
每次发现问题，请记录：
- 浏览器与版本（如 Chrome 128.0.XXXX）
- 操作系统与设备（Windows/Mac/iOS/Android，桌面/移动）
- 页面可见性变化（是否切换标签页/最小化/锁屏）
- 当前练习模式（顺序/随机/背题等）
- 设置状态（自动下一题/背题模式/选项乱序 的开关值）
- 题目编号或题干关键字

三、常见现象与快速定位
1) 答对后发生双重跳转或误跳转
- 预期：仅前进一题
- 排查要点：
  - Console 搜索关键词 autoNextTimerId，关注 showAnswer / nextQuestion / endPractice 触发顺序
  - 检查是否存在同时触发“自动跳转”和“手动下一题”的情况
  - 若在背题模式，确认是否点击了“查看答案”后触发跳转

2) 选项乱序未生效或与预期不一致
- 预期：
  - 关闭“选项乱序”时，按原始顺序展示
  - 开启时进入题目随机打乱
  - 当前实现：随机练习模式固定乱序（即使关闭开关也会乱序）
- 排查要点：
  - 记录 shouldShuffleOptions 的实际判定条件（如可在代码中临时加 log）
  - 切换前后对比题目同一题的选项顺序是否发生变化

3) 背题模式下按钮/解析显示异常
- 预期：隐藏“下一题”，显示“查看答案”；选项点击不立即显示解析
- 排查要点：
  - 确认 isMemorizeActive 判定是否受练习模式或设置开关影响
  - 观察 UI：查看答案按钮是否出现、下一题是否隐藏

4) 刷新后设置未恢复
- 预期：开关状态刷新后与刷新前一致
- 排查要点：
  - 检查 localStorage 中 practiceSettings 的值
  - 如被破坏，可执行 localStorage.removeItem('practiceSettings') 后重新配置再复测

四、数据收集清单（提交给开发/测试）
- 发生时间（本地时区）
- 浏览器/设备/系统信息
- 练习模式与设置状态三项（自动下一题/背题模式/乱序）
- 题目标识（题号/题干）
- 操作序列（尽量逐步描述：点击/等待/切换等）
- 期望结果 vs 实际结果
- Console 日志/错误堆栈/Network 关键请求
- 截图或短视频（可选）

五、缺陷报告模板（建议）
- 标题：简短描述 + 关键条件（例：自动下一题开启时双跳）
- 环境：浏览器、设备、系统
- 前置条件：模式、设置状态说明
- 复现步骤：1..n
- 实际结果：
- 期望结果：
- 附件：控制台日志、截图/视频、Network 截图
- 影响评估：频率、影响范围

六、回归与用例同步
- 缺陷修复后，请回归执行 TC031~TC035
- 若交互策略调整（例如随机模式是否遵循乱序开关、背题模式是否禁用自动跳转），请同步更新：
  - 用例预期结果
  - 本附录的“常见现象与快速定位”说明

七、当前缺陷清单（本次自动化执行）
- BUG-031：勾选“答对自动下一题”后未自动跳转
  - 影响用例：TC031、TC034
  - 复现概率：当前环境 100%
  - 现象：选择正确答案后 currentQuestionIndex 未增加，未触发跳转
  - 证据（Console 日志片段）：
    - [settings.changed] {"autoNext":true,"memorize":false,"shuffle":false}
    - [AutoPractice] TC031:afterAutoNext {"startIdx":0,"idxAfter":0}
  - 初步定位建议：
    - 检查 showAnswer 中“自动下一题”判定与计时器 setTimeout 是否生效或被覆盖/清除
    - 校验 recordAnswer→showAnswer 调用链中 correctness 判定值
    - 验证 memorize 模式判定是否错误影响了非背题模式
  - 优先级：高（影响核心体验与多个用例）
  - 修复后回归：优先复测 TC031、TC034
